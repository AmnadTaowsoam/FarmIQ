-- ===========================================
-- FarmIQ Edge — Robot Sweep (Run-based + Lab)
-- Split Migrations (PostgreSQL + TimescaleDB)
-- ===========================================
-- โครงสร้างนี้แยกไฟล์เพื่อให้รัน/ดีบักง่าย และปลอดภัยต่อ TimescaleDB
-- แนะนำให้รันตามลำดับตัวเลขจากเล็กไปใหญ่

-- ────────────────────────────────────────────────────────────────────────────
-- migrations/000_prereqs.sql  (รันใน session ใหม่)
-- ────────────────────────────────────────────────────────────────────────────
-- IMPORTANT:
--  • ให้รันไฟล์นี้แยกต่างหากเป็นคำสั่งแรกใน session ใหม่ของ psql และใส่ -X
--  • ถ้าคุณใช้สคริปต์รวม (รันทั้งหมดรวดเดียว) ให้ข้ามไฟล์นี้ไปเลยเพื่อหลีกเลี่ยง error
--  • หากเจอข้อความว่า "extension ... already been loaded with another version"
--    แปลว่ามี library เวอร์ชันหนึ่งถูกโหลดไว้แล้ว ให้ใช้คำสั่ง UPDATE แทน CREATE
--
-- ตัวเลือก A: ยังไม่เคยติดตั้งใน database นี้ (รันแยกใน session ใหม่เท่านั้น)
--   CREATE EXTENSION IF NOT EXISTS timescaledb;
--
-- ตัวเลือก B: มี extension อยู่แล้วแต่เวอร์ชันไม่ตรงกับ library ที่โหลดอยู่
--   ALTER EXTENSION timescaledb UPDATE;  -- จะอัปเดตเป็นเวอร์ชันที่รองรับ
--
-- ตรวจสอบสถานะ (ดูอย่างเดียว)
--   SELECT extname, extversion FROM pg_extension WHERE extname='timescaledb';
--
-- *** หมายเหตุสำคัญ ***
-- ถ้าคุณกำลังรันสคริปต์นี้แบบรวมทั้งไฟล์เดียว ให้ข้ามไฟล์ 000 นี้ไปเลย
-- แล้วเริ่มที่ 001 เป็นต้นไป